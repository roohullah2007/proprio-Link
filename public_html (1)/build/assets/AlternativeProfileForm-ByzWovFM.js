import{r as w,R as D,j as e,q as M,v as T,Y as R}from"./app-CV-uduzR.js";import{I as u}from"./InputError-C-GCs_UV.js";import{I as x,T as N}from"./TextInput-BYWYEjU4.js";import{u as L}from"./translations-ByLVRw2M.js";import{z as S}from"./transition-CRZGpZtR.js";function I({currentImage:v,onChange:p,error:A,userInitials:o="U"}){const{__:t}=L(),[s,a]=w.useState(v),[b,l]=w.useState(!1),[c,f]=w.useState(!1),[h,m]=w.useState(null);D.useEffect(()=>{a(v)},[v]);const C=async r=>{var i;f(!0),m(null);try{const d=new FormData;d.append("profile_image",r);const g=(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"),_=await(await fetch("/profile/upload-image",{method:"POST",headers:{"X-CSRF-TOKEN":g,Accept:"application/json"},body:d})).json();if(_.success)a(_.image_url),p&&p(_.image_url),console.log("✅ Profile image uploaded successfully!"),setTimeout(()=>{window.location.reload()},1e3);else throw new Error(_.message||"Upload failed")}catch(d){console.error("❌ Profile image upload failed:",d),m(d.message)}finally{f(!1)}},j=r=>{if(r&&r.type.startsWith("image/")){if(r.size>2*1024*1024){m("File size too large. Maximum size is 2MB.");return}if(!["image/jpeg","image/jpg","image/png","image/gif"].includes(r.type)){m("File type not allowed. Please upload JPG, PNG, or GIF images only.");return}const d=new FileReader;d.onload=g=>a(g.target.result),d.readAsDataURL(r),C(r)}},y=r=>{const i=r.target.files[0];j(i)},F=r=>{r.preventDefault(),l(!0)},n=r=>{r.preventDefault(),l(!1)},E=r=>{r.preventDefault(),l(!1);const i=r.dataTransfer.files[0];j(i)},k=async()=>{var r;f(!0);try{const i=(r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"),g=await(await fetch("/profile/remove-image-new",{method:"DELETE",headers:{"X-CSRF-TOKEN":i,Accept:"application/json"}})).json();if(g.success)a(null),p&&p(null),setTimeout(()=>{window.location.reload()},500);else throw new Error(g.message||"Removal failed")}catch(i){console.error("❌ Profile image removal failed:",i),m(i.message)}finally{f(!1)}},P=()=>o;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"relative",children:[s?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s,alt:t("Profile Image"),className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg"}),!c&&e.jsx("button",{type:"button",onClick:k,className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",title:t("Remove image"),children:"×"})]}):e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-[#0F44FC] to-[#0A37D1] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-white font-inter",children:P()})}),c&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-[#000] font-inter mb-1",children:t("Profile Photo")}),e.jsx("p",{className:"text-xs text-[#6C6C6C] font-inter mb-3",children:t("Upload a photo to personalize your profile. JPG, PNG, or GIF. Max 2MB.")}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("label",{htmlFor:"profile_image_input",className:`inline-flex items-center px-4 py-2 bg-[#0F44FC] border border-[#0F44FC] rounded-lg text-white text-sm font-medium font-inter cursor-pointer transition-colors ${c?"opacity-50 cursor-not-allowed":"hover:bg-[#0A37D1]"}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 border border-white border-t-transparent rounded-full animate-spin"}),t("Uploading...")]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),t(s?"Change Photo":"Upload Photo")]})}),s&&!c&&e.jsx("button",{type:"button",onClick:k,className:"inline-flex items-center px-4 py-2 bg-white border border-[#EAEAEA] rounded-lg text-[#6C6C6C] text-sm font-medium font-inter hover:bg-gray-50 transition-colors",children:t("Remove")})]})]})]}),e.jsx("input",{id:"profile_image_input",type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif",onChange:y,className:"hidden",disabled:c}),e.jsx("div",{onDragOver:F,onDragLeave:n,onDrop:E,className:`
                    border-2 border-dashed rounded-lg p-6 text-center transition-colors
                    ${b?"border-[#0F44FC] bg-blue-50":"border-[#EAEAEA] hover:border-[#0F44FC] hover:bg-blue-50"}
                    ${c?"opacity-50 pointer-events-none":""}
                `,children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("svg",{className:`mx-auto w-8 h-8 ${b?"text-[#0F44FC]":"text-[#6C6C6C]"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:`font-medium ${b?"text-[#0F44FC]":"text-[#6C6C6C]"} font-inter`,children:t("Drag and drop your image here")}),e.jsx("p",{className:"text-xs text-[#6C6C6C] font-inter mt-1",children:t("or click the Upload Photo button above")})]})]})}),(h||A)&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-red-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-red-800 text-sm font-inter",children:h||A})]})})]})}function O({mustVerifyEmail:v,status:p,className:A=""}){var C,j,y,F;const o=M().props.auth.user,{__:t}=L(),{data:s,setData:a,patch:b,errors:l,processing:c,recentlySuccessful:f,clearErrors:h}=T({prenom:o.prenom||"",nom:o.nom||"",email:o.email||"",telephone:o.telephone||"",numero_siret:o.numero_siret||"",licence_professionnelle:null,language:o.language||"fr"});w.useEffect(()=>{if(l&&Object.keys(l).length>0){const n=setTimeout(()=>{h()},100);return()=>clearTimeout(n)}},[s.prenom,s.nom,s.email,s.telephone]);const m=n=>{n.preventDefault(),console.log("Profile form submission (no image)",{formData:{prenom:s.prenom,nom:s.nom,email:s.email,telephone:s.telephone,numero_siret:s.numero_siret}}),h(),b(route("profile.update"),{onSuccess:E=>{console.log("✅ Profile updated successfully!"),h()},onError:E=>{console.error("❌ Profile update failed:",E)},preserveScroll:!0})};return e.jsxs("section",{className:A,children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-medium text-[#000] font-inter mb-4",children:t("Profile Photo")}),e.jsx(I,{currentImage:o.profile_image_url,userInitials:`${((j=(C=o.prenom)==null?void 0:C[0])==null?void 0:j.toUpperCase())||""}${((F=(y=o.nom)==null?void 0:y[0])==null?void 0:F.toUpperCase())||""}`})]}),e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-lg font-medium text-[#000] font-inter mb-4",children:t("Profile Information")})}),e.jsx("input",{type:"text",name:"username",autoComplete:"username",value:s.email,style:{display:"none"},readOnly:!0,"aria-hidden":"true"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"prenom",value:t("First Name"),className:"text-sm font-medium text-[#000] font-inter mb-2"}),e.jsx("div",{className:"flex items-center px-4 gap-[10px] w-full h-[39px] bg-white border-[1.5px] border-[#EAEAEA] rounded-[100px] focus-within:border-[#0F44FC] transition-colors",children:e.jsx(N,{id:"prenom",className:"flex-1 border-0 outline-none bg-transparent text-[14px] leading-[19px] font-normal text-[#5A5A5A] placeholder-[#5A5A5A] focus:outline-none focus:ring-0 focus:border-0",value:s.prenom,onChange:n=>a("prenom",n.target.value),required:!0,autoComplete:"given-name",placeholder:t("Enter your first name")})}),e.jsx(u,{className:"mt-2",message:l.prenom})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"nom",value:t("Last Name"),className:"text-sm font-medium text-[#000] font-inter mb-2"}),e.jsx("div",{className:"flex items-center px-4 gap-[10px] w-full h-[39px] bg-white border-[1.5px] border-[#EAEAEA] rounded-[100px] focus-within:border-[#0F44FC] transition-colors",children:e.jsx(N,{id:"nom",className:"flex-1 border-0 outline-none bg-transparent text-[14px] leading-[19px] font-normal text-[#5A5A5A] placeholder-[#5A5A5A] focus:outline-none focus:ring-0 focus:border-0",value:s.nom,onChange:n=>a("nom",n.target.value),required:!0,autoComplete:"family-name",placeholder:t("Enter your last name")})}),e.jsx(u,{className:"mt-2",message:l.nom})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"email",value:t("Email Address"),className:"text-sm font-medium text-[#000] font-inter mb-2"}),e.jsx("div",{className:"flex items-center px-4 gap-[10px] w-full h-[39px] bg-white border-[1.5px] border-[#EAEAEA] rounded-[100px] focus-within:border-[#0F44FC] transition-colors",children:e.jsx(N,{id:"email",type:"email",className:"flex-1 border-0 outline-none bg-transparent text-[14px] leading-[19px] font-normal text-[#5A5A5A] placeholder-[#5A5A5A] focus:outline-none focus:ring-0 focus:border-0",value:s.email,onChange:n=>a("email",n.target.value),required:!0,autoComplete:"username",placeholder:t("Enter your email address")})}),e.jsx(u,{className:"mt-2",message:l.email})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"telephone",value:t("Phone Number"),className:"text-sm font-medium text-[#000] font-inter mb-2"}),e.jsx("div",{className:"flex items-center px-4 gap-[10px] w-full h-[39px] bg-white border-[1.5px] border-[#EAEAEA] rounded-[100px] focus-within:border-[#0F44FC] transition-colors",children:e.jsx(N,{id:"telephone",type:"tel",className:"flex-1 border-0 outline-none bg-transparent text-[14px] leading-[19px] font-normal text-[#5A5A5A] placeholder-[#5A5A5A] focus:outline-none focus:ring-0 focus:border-0",value:s.telephone,onChange:n=>a("telephone",n.target.value),autoComplete:"tel",placeholder:t("Enter your phone number")})}),e.jsx(u,{className:"mt-2",message:l.telephone})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"language",value:t("Language Preference"),className:"text-sm font-medium text-[#000] font-inter mb-2"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"language",value:s.language,onChange:n=>a("language",n.target.value),className:"w-full px-4 py-2 h-[39px] bg-white border-[1.5px] border-[#EAEAEA] rounded-[100px] focus:border-[#0F44FC] focus:outline-none focus:ring-0 appearance-none text-[14px] leading-[19px] font-normal text-[#5A5A5A]",children:[e.jsx("option",{value:"fr",children:"Français (French)"}),e.jsx("option",{value:"en",children:"English"})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-[#6C6C6C]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsx("div",{className:"mt-1 text-xs text-[#6C6C6C] font-inter",children:t("Choose your preferred language for emails and notifications")}),e.jsx(u,{className:"mt-2",message:l.language})]}),o.type_utilisateur==="AGENT"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"numero_siret",value:t("SIRET Number"),className:"text-sm font-medium text-[#000] font-inter mb-2"}),e.jsx("div",{className:"flex items-center px-4 gap-[10px] w-full h-[39px] bg-white border-[1.5px] border-[#EAEAEA] rounded-[100px] focus-within:border-[#0F44FC] transition-colors",children:e.jsx(N,{id:"numero_siret",type:"text",className:"flex-1 border-0 outline-none bg-transparent text-[14px] leading-[19px] font-normal text-[#5A5A5A] placeholder-[#5A5A5A] focus:outline-none focus:ring-0 focus:border-0",value:s.numero_siret,onChange:n=>a("numero_siret",n.target.value),placeholder:t("Enter your SIRET number")})}),e.jsx(u,{className:"mt-2",message:l.numero_siret})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"licence_professionnelle",value:t("Professional License"),className:"text-sm font-medium text-[#000] font-inter mb-2"}),o.licence_professionnelle_url&&e.jsx("div",{className:"mb-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-sm text-green-800 font-medium font-inter",children:t("Current License Uploaded")})]}),e.jsx("a",{href:o.licence_professionnelle_url.startsWith("http")?o.licence_professionnelle_url:`/storage/${o.licence_professionnelle_url}`,target:"_blank",rel:"noopener noreferrer",className:"text-[#0F44FC] hover:text-[#0A37D1] text-sm font-medium underline",children:t("View Current License")})]})}),e.jsxs("div",{className:"flex items-center px-4 gap-[10px] w-full h-[39px] bg-white border-[1.5px] border-[#EAEAEA] rounded-[100px] focus-within:border-[#0F44FC] transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 text-[#6C6C6C] flex-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("label",{htmlFor:"licence_professionnelle",className:"flex-1 cursor-pointer",children:e.jsx("span",{className:"text-[14px] leading-[19px] font-normal text-[#5A5A5A]",children:s.licence_professionnelle?s.licence_professionnelle.name:o.licence_professionnelle_url?t("Replace License File"):t("Upload License File (PDF, JPG, PNG)")})}),e.jsx("input",{id:"licence_professionnelle",type:"file",accept:".pdf,.jpg,.jpeg,.png",className:"hidden",onChange:n=>a("licence_professionnelle",n.target.files[0])})]}),e.jsx("div",{className:"mt-1 text-xs text-[#6C6C6C] font-inter",children:t("Upload your professional license document (PDF, JPG, PNG). Maximum file size: 5MB")}),e.jsx(u,{className:"mt-2",message:l.licence_professionnelle})]})]}),v&&o.email_verified_at===null&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("svg",{className:"w-5 h-5 text-yellow-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-yellow-800 font-inter",children:t("Your email address is unverified.")}),e.jsx(R,{href:route("verification.send"),method:"post",as:"button",className:"mt-2 text-sm text-yellow-700 underline hover:text-yellow-800 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 rounded font-inter",children:t("Click here to re-send the verification email.")})]})]}),p==="verification-link-sent"&&e.jsx("div",{className:"mt-3 text-sm font-medium text-green-700 bg-green-50 border border-green-200 rounded-lg p-3",children:t("A new verification link has been sent to your email address.")})]}),l.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-red-800 font-inter",children:l.general})})]})}),e.jsx("div",{className:"flex items-center justify-between pt-4 border-t border-[#EAEAEA]",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{type:"submit",disabled:c,className:"flex justify-center items-center px-6 py-3 gap-2 bg-[#0F44FC] border border-[#0F44FC] rounded-lg text-white font-medium font-inter transition-colors hover:bg-[#0A37D1] focus:outline-none focus:bg-[#0A37D1] disabled:opacity-50 disabled:cursor-not-allowed",children:[c&&e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),t("Save Changes")]}),e.jsx(S,{show:f,enter:"transition ease-in-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"transition ease-in-out duration-300",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm font-medium font-inter",children:t("Changes saved successfully!")})]})})]})})]})]})}export{O as default};
