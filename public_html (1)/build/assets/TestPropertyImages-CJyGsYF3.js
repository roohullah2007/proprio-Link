import{r as h,j as e,$ as b}from"./app-iFD7Weej.js";import{A as j}from"./AuthenticatedLayout-DWhC2xWj.js";import{P as g}from"./PropertyImage-ji4gt88r.js";import"./ApplicationLogo-BMRKG7mZ.js";import"./Dropdown-CjFkiSaH.js";import"./transition-F1nsk1y3.js";import"./LanguageSwitcher-CvGVWDg5.js";import"./translations-rX8tNeDX.js";const f=({image:l,propertyId:d})=>{const[s,r]=h.useState(null),[i,n]=h.useState({});h.useEffect(()=>{l&&(r({imageId:l.id,cheminFichier:l.chemin_fichier,propertyId:d,urls:{storage:`/storage/${l.chemin_fichier}`,images:`/images/${l.chemin_fichier}`,direct:`${window.location.origin}/storage/${l.chemin_fichier}`}}),x(l.chemin_fichier))},[l,d]);const x=async a=>{const t=[`/storage/${a}`,`/images/${a}`,`${window.location.origin}/storage/${a}`],c={};for(const m of t)try{const o=await fetch(m,{method:"HEAD"});c[m]={status:o.status,ok:o.ok,contentType:o.headers.get("content-type"),contentLength:o.headers.get("content-length")}}catch(o){c[m]={status:"ERROR",error:o.message}}n(c),console.log("🖼️ Image URL Test Results:",c)},u=a=>{const t=new Image;t.onload=()=>console.log(`✅ Image loaded successfully: ${a}`),t.onerror=()=>console.log(`❌ Image failed to load: ${a}`),t.src=a};return s?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 m-4",children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-800 mb-2",children:"🐛 Image Debug Info"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Image ID:"})," ",s.imageId]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Property ID:"})," ",s.propertyId]}),e.jsxs("div",{children:[e.jsx("strong",{children:"File Path:"})," ",s.cheminFichier]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("strong",{children:"URLs being tested:"}),e.jsx("div",{className:"space-y-1 mt-2",children:Object.entries(s.urls).map(([a,t])=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-16 text-xs bg-gray-100 px-2 py-1 rounded",children:a}),e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded flex-1",children:t}),e.jsx("button",{onClick:()=>u(t),className:"text-xs bg-blue-100 hover:bg-blue-200 px-2 py-1 rounded",children:"Test"}),i[t]&&e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${i[t].ok?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[i[t].ok?"✅":"❌"," ",i[t].status]})]},a))})]}),e.jsxs("div",{className:"mt-4 p-2 bg-gray-100 rounded",children:[e.jsx("strong",{children:"Console Instructions:"}),e.jsx("div",{className:"text-xs mt-1",children:"Open browser console (F12) to see detailed image loading results. Look for messages starting with 🖼️ or ❌/✅"})]})]})]}):null};function k({auth:l,properties:d=[]}){return e.jsxs(j,{user:l.user,children:[e.jsx(b,{title:"Test Property Images"}),e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"🖼️ Property Images Test Page"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsx("h2",{className:"font-bold text-blue-800",children:"Instructions:"}),e.jsxs("ol",{className:"list-decimal list-inside text-blue-700 space-y-1 mt-2",children:[e.jsx("li",{children:"Open browser console (F12) to see detailed logs"}),e.jsx("li",{children:"Look for messages starting with 🖼️, ✅, ❌"}),e.jsx("li",{children:"Check which URLs are failing/succeeding"}),e.jsx("li",{children:'Right-click on broken images → "Inspect" to see what URL is being used'})]})]}),d.length===0?e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:e.jsx("p",{className:"text-yellow-800",children:"No properties with images found to test."})}):e.jsx("div",{className:"space-y-8",children:d.map(s=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Property ",s.id," - ",s.type_propriete," in ",s.ville]}),s.images&&s.images.length>0?e.jsx("div",{className:"space-y-6",children:s.images.map((r,i)=>e.jsxs("div",{className:"border border-gray-300 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium mb-3",children:["Image ",i+1," (ID: ",r.id,")"]}),e.jsx(f,{image:r,propertyId:s.id}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2",children:"PropertyImage Component (Normal)"}),e.jsx(g,{image:r,alt:`Property ${s.id} image ${i+1}`,className:"w-full h-32 object-cover rounded border",fallbackClassName:"w-full h-32 rounded border"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2",children:"PropertyImage Component (Debug)"}),e.jsx(g,{image:r,alt:`Property ${s.id} image ${i+1}`,className:"w-full h-32 object-cover rounded border",fallbackClassName:"w-full h-32 rounded border",debug:!0})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2",children:"Raw IMG Element"}),e.jsx("img",{src:`/storage/${r.chemin_fichier}`,alt:"Raw image test",className:"w-full h-32 object-cover rounded border",onError:n=>{console.log("❌ Raw IMG failed:",n.target.src),n.target.style.display="none",n.target.nextElementSibling.style.display="block"},onLoad:n=>{console.log("✅ Raw IMG loaded:",n.target.src)}}),e.jsx("div",{className:"w-full h-32 bg-red-200 flex items-center justify-center rounded border",style:{display:"none"},children:e.jsx("span",{className:"text-red-800 text-sm",children:"Raw IMG Failed"})})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded",children:[e.jsx("h5",{className:"font-medium mb-2",children:"URLs to test manually:"}),e.jsxs("div",{className:"space-y-1 text-sm font-mono",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Storage:"}),e.jsxs("a",{href:`/storage/${r.chemin_fichier}`,target:"_blank",className:"text-blue-600 hover:underline ml-2",children:["/storage/",r.chemin_fichier]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Images:"}),e.jsxs("a",{href:`/images/${r.chemin_fichier}`,target:"_blank",className:"text-blue-600 hover:underline ml-2",children:["/images/",r.chemin_fichier]})]})]})]})]},r.id))}):e.jsx("p",{className:"text-gray-600",children:"No images for this property"})]},s.id))})]})})]})}export{k as default};
